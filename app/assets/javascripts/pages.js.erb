$(document).ready(function(){
  L.mapbox.accessToken = '<%= ENV['MAPBOX_KEY'] %>';
  var map = L.mapbox.map('map', 'mapbox.dark').setView([39.114102, -94.627478], 5);

  var data = [
  { city: "San Francisco", temp: "98.3", latitude: 39.984, longitude: -75.343 },
  { city: "San Francisco", temp: "98.7", latitude: 39.284, longitude: -75.833 },
  { city: "San Francisco", temp: "98.5", latitude: 39.123, longitude: -74.534 }
  ];

  var geojson_objects = GeoJSON.parse(data, {Point: ['latitude', 'longitude']});

  var myLayer = L.mapbox.featureLayer().addTo(map);
  myLayer.on('layeradd', function(e){
    var marker = e.layer;
    feature = marker.feature;
    var content = '<h2><a href="http://www.google.com">'+ feature.properties.city+'</a></h2><p>'+feature.properties.temp+'</p>';
    marker.bindPopup(content);
  });

  myLayer.setGeoJSON(geojson_objects);

});

